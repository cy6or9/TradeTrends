<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script data-noptimize="1" data-cfasync="false" data-wpfc-render="false">
    (function () {
        var script = document.createElement("script");
        script.async = 1;
        script.src = 'https://emrldtp.cc/NDg3NDU2.js?t=487456';
        script.onerror = function() { console.log('[Analytics] Third-party script blocked or unavailable'); };
        document.head.appendChild(script);
    })();
  </script>
  <title>TradeTrends Deals — Amazon Finds + Travel Promos</title>
  <meta name="description" content="Fast-loading deals hub: curated Amazon finds plus travel promos. Updated often." />
  <meta name="theme-color" content="#0b0f14" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://tradetrend.netlify.app/" />
  <meta property="og:title" content="TradeTrends Deals — Amazon Finds + Travel Promos" />
  <meta property="og:description" content="Curated Amazon products and travel deals that convert. Fast, clean, Pinterest-ready." />
  <meta property="og:image" content="https://tradetrend.netlify.app/assets/img_0358.webp" />
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:url" content="https://tradetrend.netlify.app/" />
  <meta name="twitter:title" content="TradeTrends Deals — Amazon Finds + Travel Promos" />
  <meta name="twitter:description" content="Curated Amazon products and travel deals that convert. Fast, clean, Pinterest-ready." />
  <meta name="twitter:image" content="https://tradetrend.netlify.app/assets/img_0358.webp" />
  
  <!-- Canonical -->
  <link rel="canonical" href="https://tradetrend.netlify.app/" />
  <link rel="preconnect" href="https://images.unsplash.com">
  <link rel="stylesheet" href="/css/styles.css" />
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script>
    // Suppress external resource loading errors from third-party scripts
    window.addEventListener('error', function(e) {
      if (e.target && (e.target.tagName === 'IMG' || e.target.tagName === 'SCRIPT')) {
        const src = e.target.src || '';
        if (src.includes('ibspot.com') || src.includes('bbystatic.com') || src.includes('emrldtp.cc')) {
          e.preventDefault();
          return false;
        }
      }
    }, true);
    
    // Safety net: Forward broken /?network=...&id=... links to /go redirect
    (function(){
      const params = new URLSearchParams(window.location.search);
      const network = params.get('network');
      const id = params.get('id');
      if (network && id && (window.location.pathname === '/' || window.location.pathname.endsWith('.html'))) {
        window.location.replace(`/go?network=${encodeURIComponent(network)}&id=${encodeURIComponent(id)}`);
      }
    })();
  </script>
</head>
<body>

<header class="header">
  <div class="container">
    <div class="nav">
      <a class="brand" href="/">
        <span class="logo" aria-hidden="true"></span>
        <span>TradeTrends Deals</span>
      </a>
      <nav class="navlinks" aria-label="Primary">
        <a class="pill" href="/#shop">Shop</a>
        <a class="pill" href="/#activities">Activities</a>
        <button class="pill hamburger" id="moreMenuBtn" aria-label="More options" aria-expanded="false">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
          More
        </button>
      </nav>
      <div class="more-menu" id="moreMenu" style="display:none;">
        <a href="/products.html">All Products</a>
        <a href="/activities.html">All Activities</a>
        <a id="adminLink" href="/admin/" style="display:none;">Admin</a>
      </div>
    </div>
  </div>
</header>

<main class="container">
  <section class="section" id="shop" data-testid="section-shop">
    <div class="sectionHeader">
      <div>
        <h2>Shop</h2>
        <p>Curated products with a quick reason to buy.</p>
      </div>
      <div class="carousel-controls">
        <button class="carousel-btn carousel-prev" data-carousel="shop" aria-label="Previous products">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
        <button class="carousel-btn carousel-next" data-carousel="shop" aria-label="Next products">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </button>
      </div>
    </div>
    <div class="carousel-row" id="amzGrid" data-testid="carousel-shop" aria-live="polite"></div>
    <div class="see-more-wrapper">
      <a href="/products.html" class="see-more" data-testid="see-more-shop">See more products →</a>
    </div>
  </section>

  <section class="section" id="activities" data-testid="section-activities">
    <div class="sectionHeader">
      <div>
        <h2>Popular Activities</h2>
        <p>Top-rated tours, attractions & experiences worldwide.</p>
      </div>
      <div class="carousel-controls">
        <button class="carousel-btn carousel-prev" data-carousel="activities" aria-label="Previous activities">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
        <button class="carousel-btn carousel-next" data-carousel="activities" aria-label="Next activities">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </button>
      </div>
    </div>
    <div class="carousel-row" id="actGrid" data-testid="carousel-activities" aria-live="polite"></div>
    <div class="see-more-wrapper">
      <a href="/activities.html" class="see-more" data-testid="see-more-activities">See more activities →</a>
    </div>
  </section>
</main>

<script src="/js/render.js?v=3"></script>
<script>
  // Initialize carousel sections (homepage shows first 12 items)
  TT.initCarouselSection({
    container: "#amzGrid",
    json: "/data/amazon.json",
    kind: "amazon",
    maxItems: 12
  });
  TT.initCarouselSection({
    container: "#actGrid",
    json: "/data/activities.json",
    kind: "activities",
    maxItems: 12
  });

  // Initialize carousel controls
  TT.initCarousel('shop', '#amzGrid');
  TT.initCarousel('activities', '#actGrid');

  // More menu toggle
  const moreMenuBtn = document.getElementById('moreMenuBtn');
  const moreMenu = document.getElementById('moreMenu');
  
  if (moreMenuBtn && moreMenu) {
    moreMenuBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      const isOpen = moreMenu.style.display === 'block';
      moreMenu.style.display = isOpen ? 'none' : 'block';
      moreMenuBtn.setAttribute('aria-expanded', !isOpen);
    });

    document.addEventListener('click', () => {
      moreMenu.style.display = 'none';
      moreMenuBtn.setAttribute('aria-expanded', 'false');
    });

    moreMenu.addEventListener('click', (e) => {
      e.stopPropagation();
    });
  }
</script>

<footer class="footer">
  <div class="container">
    <div class="notice">
      <b>Affiliate disclosure:</b> Some links on this site are affiliate links. If you click and purchase, we may earn a commission at no extra cost to you.
      <div style="height:8px"></div>
      <span class="small">Tip: For best results on Pinterest, link your pins to a relevant section (Amazon or Travel) or to the dedicated category page.</span>
    </div>
    <div style="height:14px"></div>
    <div class="small">© <span id="y"></span> TradeTrends Deals • Built for speed on Netlify</div>
    <div style="height:14px"></div>
    <div class="auth-buttons">
      <span id="authStatus" class="small"></span>
      <button id="loginBtn" class="auth-btn" style="display:none;">Login</button>
      <button id="logoutBtn" class="auth-btn" style="display:none;">Logout</button>
    </div>
  </div>
</footer>
<script>
  document.getElementById('y').textContent = new Date().getFullYear();
  
  // Netlify Identity Authentication
  const authStatus = document.getElementById('authStatus');
  const loginBtn = document.getElementById('loginBtn');
  const logoutBtn = document.getElementById('logoutBtn');
  
  function updateAuthUI() {
    const user = netlifyIdentity.currentUser();
    
    if (user) {
      const email = user.email || 'User';
      const name = user.user_metadata?.full_name || email;
      authStatus.textContent = `Logged in as: ${name}`;
      loginBtn.style.display = 'none';
      logoutBtn.style.display = 'inline-flex';
    } else {
      authStatus.textContent = 'Not logged in';
      loginBtn.style.display = 'inline-flex';
      logoutBtn.style.display = 'none';
    }
  }
  
  // Initialize Netlify Identity
  if (window.netlifyIdentity) {
    netlifyIdentity.on('init', user => {
      updateAuthUI();
      checkAdminAccess();
    });
    
    netlifyIdentity.on('login', user => {
      updateAuthUI();
      checkAdminAccess();
      netlifyIdentity.close();
    });
    
    netlifyIdentity.on('logout', () => {
      updateAuthUI();
      hideAdminLink();
    });
    
    netlifyIdentity.init();
  } else {
    // If Identity not loaded, show login button and check admin in dev mode
    authStatus.textContent = 'Guest';
    loginBtn.style.display = 'none';
    logoutBtn.style.display = 'none';
    checkAdminAccess();
  }

  // Check if user is admin and show/hide admin link
  function checkAdminAccess() {
    const adminLink = document.getElementById('adminLink');
    if (!adminLink) return;
    
    // Check if in dev mode
    const hostname = window.location.hostname;
    const isDevMode = hostname === 'localhost' || 
                      hostname.includes('127.0.0.1') ||
                      hostname.includes('app.github.dev') ||
                      hostname.includes('gitpod.io') ||
                      hostname.includes('codespaces');
    
    // Show admin link in dev mode OR for logged-in admin users
    if (isDevMode) {
      adminLink.style.display = 'inline-flex';
      return;
    }
    
    if (window.netlifyIdentity) {
      const user = netlifyIdentity.currentUser();
      if (user) {
        const roles = user.app_metadata?.roles || [];
        if (roles.includes('admin')) {
          adminLink.style.display = 'inline-flex';
          return;
        }
      }
    }
    adminLink.style.display = 'none';
  }
  
  function hideAdminLink() {
    const adminLink = document.getElementById('adminLink');
    if (adminLink) adminLink.style.display = 'none';
  }
  
  // Login button handler
  loginBtn.addEventListener('click', () => {
    if (window.netlifyIdentity) {
      netlifyIdentity.open('login');
    }
  });
  
  // Logout button handler
  logoutBtn.addEventListener('click', () => {
    if (window.netlifyIdentity) {
      const confirmed = confirm('Are you sure you want to logout?');
      if (confirmed) {
        netlifyIdentity.logout();
      }
    }
  });
</script>
</body>
</html>
