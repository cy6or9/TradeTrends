{
  "patterns": [
    {
      "pattern": "href=\"/?network=",
      "reason": "Old broken URL pattern - should be /go?network=",
      "blockedAt": "2026-01-12",
      "severity": "CRITICAL"
    },
    {
      "pattern": "fetch\\(['\"]\/api\/",
      "reason": "Admin pages using /api instead of /.netlify/functions/api - Identity will intercept",
      "blockedAt": "2026-01-12",
      "severity": "CRITICAL"
    },
    {
      "pattern": "Unexpected token '<'",
      "reason": "HTML returned instead of JSON - symptom of Identity interception",
      "blockedAt": "2026-01-12",
      "severity": "CRITICAL",
      "symptom": true
    },
    {
      "pattern": "text/html.*application/json",
      "reason": "Missing content-type guard in fetch - will parse HTML as JSON",
      "blockedAt": "2026-01-12",
      "severity": "HIGH"
    },
    {
      "pattern": "/go  /.netlify/functions/go  200$",
      "reason": "Missing force flag (!) - allows SPA catch-all to override",
      "blockedAt": "2026-01-12",
      "severity": "CRITICAL"
    },
    {
      "pattern": "/*  /index.html  200\\n/go",
      "reason": "Catch-all before /go - wrong precedence order",
      "blockedAt": "2026-01-12",
      "severity": "CRITICAL"
    },
    {
      "pattern": "affiliate_url.*example\\.com",
      "reason": "Placeholder affiliate URL in production data",
      "blockedAt": "2026-01-12",
      "severity": "HIGH"
    },
    {
      "pattern": "\"affiliate_url\":\\s*\"\"",
      "reason": "Empty affiliate URL - no revenue possible",
      "blockedAt": "2026-01-12",
      "severity": "CRITICAL"
    },
    {
      "pattern": "analytics-not-recording",
      "reason": "Analytics system fails to record clicks - revenue tracking broken",
      "blockedAt": "2026-01-12",
      "severity": "CRITICAL"
    },
    {
      "pattern": "/api.*200[^!]",
      "reason": "Missing force flag on /api redirect - allows file override",
      "blockedAt": "2026-01-12",
      "severity": "HIGH"
    },
    {
      "pattern": "affiliate_url.*tradetrend\\.netlify\\.app",
      "reason": "Self-redirect: affiliate URL points to own domain causing infinite loops",
      "blockedAt": "2026-01-13",
      "severity": "CRITICAL"
    },
    {
      "pattern": "affiliate_url.*localhost",
      "reason": "Self-redirect: affiliate URL points to localhost",
      "blockedAt": "2026-01-13",
      "severity": "CRITICAL"
    }
  ],
  "filePatterns": {
    "public/_redirects": {
      "mustContain": [
        "/go  /.netlify/functions/go  200!",
        "/go/*  /.netlify/functions/go  200!",
        "/api/*  /.netlify/functions/api  200!"
      ],
      "mustNotContain": [
        "/go  /.netlify/functions/go  200$",
        "/api/*  /.netlify/functions/api  200$"
      ]
    },
    "public/data/*.json": {
      "mustNotContain": [
        "\"affiliate_url\": \"\"",
        "example.com",
        "placeholder"
      ]
    },
    "public/js/render.js": {
      "mustContain": [
        "/go?network="
      ],
      "mustNotContain": [
        "/?network="
      ]
    },
    "netlify/functions/go.js": {
      "mustContain": [
        "recordClick",
        "initializeAnalytics",
        "forbiddenHosts",
        "logIncident"
      ],
      "mustNotContain": [
        "// Continue with redirect even if logging fails"
      ]
    },
    "netlify/functions/api.js": {
      "mustContain": [
        "getAnalyticsSummary",
        "initializeAnalytics",
        "initialized"
      ]
    }
  }
}
